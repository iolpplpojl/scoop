{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\OWNER\\\\Documents\\\\GitHub\\\\scoop\\\\scoop_front\\\\src\\\\component\\\\RightClickContainer.jsx\",\n  _s = $RefreshSig$();\nimport { useState, useRef, useEffect } from \"react\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst RightClickContainer = ({\n  userId,\n  loggedInUserId,\n  addFriend,\n  deleteFriend,\n  children,\n  setHandleContextMenu\n}) => {\n  _s();\n  const [showMenu, setShowMenu] = useState(false);\n  const [menuPosition, setMenuPosition] = useState({\n    x: 0,\n    y: 0\n  });\n  const [selectedUserId, setSelectedUserId] = useState(null);\n  const [isFriend, setIsFriend] = useState(null);\n  const menuRef = useRef(null);\n  const REST = process.env.REACT_APP_RESTURL;\n\n  // 우클릭 이벤트 핸들러\n  async function handleContextMenu(event, id) {\n    if (String(id) === String(loggedInUserId)) return;\n    event.preventDefault();\n    setSelectedUserId(id);\n    setMenuPosition({\n      x: event.pageX,\n      y: event.pageY\n    });\n    try {\n      const res = await fetch(`https://${REST}/api/isfriend?userId=${id}&myId=${loggedInUserId}`);\n      const data = await res.json();\n      setIsFriend(data && (data.state === true || data.state === 1));\n    } catch (err) {\n      console.error(\"친구 상태 확인 실패\", err);\n      setIsFriend(false);\n    }\n    setShowMenu(true);\n  }\n\n  // 외부 클릭 시 닫기\n  useEffect(() => {\n    function handleClickOutside(event) {\n      if (menuRef.current && !menuRef.current.contains(event.target)) {\n        closeMenu();\n      }\n    }\n    document.addEventListener(\"mousedown\", handleClickOutside);\n    return () => {\n      document.removeEventListener(\"mousedown\", handleClickOutside);\n    };\n  }, []);\n\n  // 우클릭 핸들러 외부로 전달\n  useEffect(() => {\n    if (setHandleContextMenu) {\n      setHandleContextMenu(() => handleContextMenu);\n    }\n  }, [setHandleContextMenu]);\n  function closeMenu() {\n    setShowMenu(false);\n    setSelectedUserId(null);\n    setIsFriend(null);\n  }\n\n  // ✅ 1:1 채팅 함수 분리\n  const handleDirectMessage = async () => {\n    try {\n      const url = `https://${REST}/api/dm?id=${loggedInUserId}&to=${selectedUserId}`;\n      const res = await fetch(url, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: null // ✅ @RequestParam은 body 필요 없음\n      });\n      if (!res.ok) {\n        throw new Error(`서버 응답 에러: ${res.status}`);\n      }\n      const data = await res.json();\n      const chatroomId = data.chatroomId || data;\n      if (!chatroomId) {\n        alert(\"채팅방 ID를 찾을 수 없습니다.\");\n        return;\n      }\n      window.location.href = `/channel/@me/${chatroomId}`;\n    } catch (err) {\n      console.error(\"❌ 채팅방 이동 실패:\", err);\n      alert(\"1:1 채팅을 시작할 수 없습니다.\");\n    } finally {\n      closeMenu();\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"li\", {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: \"inline-block\",\n        width: \"100%\"\n      },\n      children: [children, showMenu && /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: menuRef,\n        style: {\n          position: \"absolute\",\n          top: menuPosition.y,\n          left: menuPosition.x,\n          background: \"#fff\",\n          border: \"1px solid #ccc\",\n          padding: \"5px\",\n          boxShadow: \"2px 2px 5px rgba(0,0,0,0.2)\",\n          zIndex: 999\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => alert(\"정보보기\"),\n          children: \"\\uC815\\uBCF4\\uBCF4\\uAE30\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleDirectMessage,\n          children: \"1:1 \\uCC44\\uD305\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 11\n        }, this), isFriend ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: async () => {\n              await deleteFriend(selectedUserId, loggedInUserId);\n              closeMenu();\n            },\n            children: \"\\uCE5C\\uAD6C \\uC0AD\\uC81C\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 15\n          }, this)\n        }, void 0, false) : /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => {\n            addFriend(selectedUserId);\n            closeMenu();\n          },\n          children: \"\\uCE5C\\uAD6C \\uCD94\\uAC00\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 5\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 100,\n    columnNumber: 5\n  }, this);\n};\n_s(RightClickContainer, \"38/niEHLwSEL2IgxV0GCPpy/kY4=\");\n_c = RightClickContainer;\nexport default RightClickContainer;\nvar _c;\n$RefreshReg$(_c, \"RightClickContainer\");","map":{"version":3,"names":["useState","useRef","useEffect","jsxDEV","_jsxDEV","Fragment","_Fragment","RightClickContainer","userId","loggedInUserId","addFriend","deleteFriend","children","setHandleContextMenu","_s","showMenu","setShowMenu","menuPosition","setMenuPosition","x","y","selectedUserId","setSelectedUserId","isFriend","setIsFriend","menuRef","REST","process","env","REACT_APP_RESTURL","handleContextMenu","event","id","String","preventDefault","pageX","pageY","res","fetch","data","json","state","err","console","error","handleClickOutside","current","contains","target","closeMenu","document","addEventListener","removeEventListener","handleDirectMessage","url","method","headers","body","ok","Error","status","chatroomId","alert","window","location","href","style","display","width","ref","position","top","left","background","border","padding","boxShadow","zIndex","onClick","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/OWNER/Documents/GitHub/scoop/scoop_front/src/component/RightClickContainer.jsx"],"sourcesContent":["import { useState, useRef, useEffect } from \"react\";\r\n\r\nconst RightClickContainer = ({\r\n  userId,\r\n  loggedInUserId,\r\n  addFriend,\r\n  deleteFriend,\r\n  children,\r\n  setHandleContextMenu,\r\n}) => {\r\n  const [showMenu, setShowMenu] = useState(false);\r\n  const [menuPosition, setMenuPosition] = useState({ x: 0, y: 0 });\r\n  const [selectedUserId, setSelectedUserId] = useState(null);\r\n  const [isFriend, setIsFriend] = useState(null);\r\n  const menuRef = useRef(null);\r\n  const REST = process.env.REACT_APP_RESTURL;\r\n\r\n  // 우클릭 이벤트 핸들러\r\n  async function handleContextMenu(event, id) {\r\n    if (String(id) === String(loggedInUserId)) return;\r\n\r\n    event.preventDefault();\r\n    setSelectedUserId(id);\r\n    setMenuPosition({ x: event.pageX, y: event.pageY });\r\n\r\n    try {\r\n      const res = await fetch(\r\n        `https://${REST}/api/isfriend?userId=${id}&myId=${loggedInUserId}`\r\n      );\r\n      const data = await res.json();\r\n      setIsFriend(data && (data.state === true || data.state === 1));\r\n    } catch (err) {\r\n      console.error(\"친구 상태 확인 실패\", err);\r\n      setIsFriend(false);\r\n    }\r\n\r\n    setShowMenu(true);\r\n  }\r\n\r\n  // 외부 클릭 시 닫기\r\n  useEffect(() => {\r\n    function handleClickOutside(event) {\r\n      if (menuRef.current && !menuRef.current.contains(event.target)) {\r\n        closeMenu();\r\n      }\r\n    }\r\n    document.addEventListener(\"mousedown\", handleClickOutside);\r\n    return () => {\r\n      document.removeEventListener(\"mousedown\", handleClickOutside);\r\n    };\r\n  }, []);\r\n\r\n  // 우클릭 핸들러 외부로 전달\r\n  useEffect(() => {\r\n    if (setHandleContextMenu) {\r\n      setHandleContextMenu(() => handleContextMenu);\r\n    }\r\n  }, [setHandleContextMenu]);\r\n\r\n  function closeMenu() {\r\n    setShowMenu(false);\r\n    setSelectedUserId(null);\r\n    setIsFriend(null);\r\n  }\r\n\r\n  // ✅ 1:1 채팅 함수 분리\r\n  const handleDirectMessage = async () => {\r\n    try {\r\n      const url = `https://${REST}/api/dm?id=${loggedInUserId}&to=${selectedUserId}`;\r\n      const res = await fetch(url, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: null, // ✅ @RequestParam은 body 필요 없음\r\n      });\r\n  \r\n      if (!res.ok) {\r\n        throw new Error(`서버 응답 에러: ${res.status}`);\r\n      }\r\n  \r\n      const data = await res.json();\r\n      const chatroomId = data.chatroomId || data;\r\n  \r\n      if (!chatroomId) {\r\n        alert(\"채팅방 ID를 찾을 수 없습니다.\");\r\n        return;\r\n      }\r\n  \r\n      window.location.href = `/channel/@me/${chatroomId}`;\r\n    } catch (err) {\r\n      console.error(\"❌ 채팅방 이동 실패:\", err);\r\n      alert(\"1:1 채팅을 시작할 수 없습니다.\");\r\n    } finally {\r\n      closeMenu();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <li>\r\n    <div style={{ display: \"inline-block\", width: \"100%\" }}>\r\n      {children}\r\n\r\n      {showMenu && (\r\n        <div\r\n          ref={menuRef}\r\n          style={{\r\n            position: \"absolute\",\r\n            top: menuPosition.y,\r\n            left: menuPosition.x,\r\n            background: \"#fff\",\r\n            border: \"1px solid #ccc\",\r\n            padding: \"5px\",\r\n            boxShadow: \"2px 2px 5px rgba(0,0,0,0.2)\",\r\n            zIndex: 999,\r\n          }}\r\n        >\r\n          <button onClick={() => alert(\"정보보기\")}>정보보기</button>\r\n          <button onClick={handleDirectMessage}>1:1 채팅</button>\r\n          {isFriend ? (\r\n            <>\r\n\r\n              <button\r\n                onClick={async () => {\r\n                  await deleteFriend(selectedUserId, loggedInUserId);\r\n                  closeMenu();\r\n                }}\r\n              >\r\n                친구 삭제\r\n              </button>\r\n            </>\r\n          ) : (\r\n            <button\r\n              onClick={() => {\r\n                addFriend(selectedUserId);\r\n                closeMenu();\r\n              }}\r\n            >\r\n              친구 추가\r\n            </button>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n    </li>\r\n  );\r\n};\r\n\r\nexport default RightClickContainer;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}